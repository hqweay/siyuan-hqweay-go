# SQL输入区域展开/折叠功能测试

## 测试目的
验证当presetSql为空时，SQL输入区域默认折叠，并支持用户手动展开的功能。

## 测试场景

### 场景1：无预设SQL的默认状态
**步骤**：
1. 打开CustomSqlPanel组件（presetSql为空）
2. 检查SQL输入区域是否默认折叠
3. 验证标题栏是否显示"展开"按钮

**预期结果**：
- ✅ SQL输入区域默认折叠（不可见）
- ✅ 标题栏显示"自定义 SQL 查询"
- ✅ 右侧显示"展开"按钮和向下箭头

### 场景2：手动展开功能
**步骤**：
1. 点击标题栏或"展开"按钮
2. 验证SQL输入区域是否展开
3. 检查按钮文字是否变为"折叠"

**预期结果**：
- ✅ SQL输入区域展开，显示SQL输入框、按钮、示例等
- ✅ 按钮文字变为"折叠"
- ✅ 箭头方向变为向上

### 场景3：手动折叠功能
**步骤**：
1. 在展开状态下点击标题栏或"折叠"按钮
2. 验证SQL输入区域是否折叠
3. 检查按钮文字是否变为"展开"

**预期结果**：
- ✅ SQL输入区域折叠隐藏
- ✅ 按钮文字变为"展开"
- ✅ 箭头方向变为向下

### 场景4：有预设SQL的状态
**步骤**：
1. 传递presetSql参数给CustomSqlPanel
2. 检查SQL输入区域是否默认展开
3. 验证按钮文字是否为"折叠"

**预期结果**：
- ✅ SQL输入区域默认展开
- ✅ presetSql内容预填充到输入框
- ✅ 按钮文字显示"折叠"
- ✅ 可能自动执行SQL或保持待执行状态

### 场景5：交互体验测试
**步骤**：
1. 测试点击整个标题栏的响应
2. 测试点击"展开/折叠"按钮的响应
3. 验证hover效果是否正常
4. 测试快速连续点击的稳定性

**预期结果**：
- ✅ 标题栏可点击，有hover效果
- ✅ 按钮可点击，响应正常
- ✅ hover时有视觉反馈（背景色变化、轻微上移）
- ✅ 快速点击无异常状态

### 场景6：状态持久性测试
**步骤**：
1. 展开SQL输入区域
2. 在输入框中输入一些内容
3. 折叠区域
4. 再次展开
5. 验证内容是否保持

**预期结果**：
- ✅ 折叠前输入的内容在展开后仍然保留
- ✅ 展开/折叠不影响已输入的SQL内容

## 测试数据

### 测试用例1：完全空的presetSql
```typescript
<CustomSqlPanel presetSql="" />
```

### 测试用例2：有内容的presetSql
```typescript
<CustomSqlPanel presetSql="SELECT * FROM blocks WHERE type = 'd' LIMIT 10" />
```

### 测试用例3：未定义presetSql
```typescript
<CustomSqlPanel />
```

## 界面元素验证

### 标题栏元素
- ✅ 左侧标题："自定义 SQL 查询"
- ✅ 右侧帮助文字："Ctrl+Enter 执行查询"
- ✅ 展开/折叠按钮
- ✅ 箭头图标

### 折叠状态
- ✅ SQL输入区域完全隐藏
- ✅ 标题栏保持可见
- ✅ 按钮状态正确

### 展开状态
- ✅ 所有SQL输入元素可见
- ✅ 输入框、按钮、示例SQL等正常显示
- ✅ 原有功能不受影响

## 兼容性验证

### 与现有功能兼容
- ✅ 保存SQL功能正常工作
- ✅ 删除SQL功能正常工作
- ✅ 执行SQL功能正常工作
- ✅ 示例SQL功能正常工作

### 响应式设计
- ✅ 桌面端显示正常
- ✅ 移动端布局适配

## 预期用户体验改善

1. **界面简洁**：无预设SQL时，界面更简洁，减少视觉干扰
2. **按需展开**：用户可以根据需要展开SQL编辑区域
3. **状态保持**：展开/折叠不影响已输入的内容
4. **直观操作**：点击标题栏或按钮都可以控制展开/折叠
5. **视觉反馈**：hover效果和状态变化提供良好的交互反馈

## 测试环境
- 浏览器：Chrome/Safari/Firefox
- 操作系统：macOS/Windows/Linux
- 测试时间：2025-12-20
- 组件版本：CustomSqlPanel 最新版本